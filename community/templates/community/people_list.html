{% extends 'community/base.html' %}
{% block content %}
{% load staticfiles %}

<!--{% if featured_image %}
    <header id="masthead" class="site-header" style="background:{{ featured_image.url }} no-repeat center / cover;">
{% else %}
    <header id="masthead" class="site-header" style="background:{% static 'news/img/ybf-bg.jpg' %} no-repeat center / cover;">
{% endif %}-->
<style>
    .loader {
        position: relative;
        left: 50%;
        top: 50%;
        z-index: 1;
        width: 150px;
        height: 150px;
        margin: -75px 0 0 -75px;
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid #3498db;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }

    @-webkit-keyframes spin {
        0% {
            -webkit-transform: rotate(0deg);
        }
        100% {
            -webkit-transform: rotate(360deg);
        }
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }
</style>
<header id="masthead" class="site-header" style="background:{% static 'communnity/img/ybf-bg.jpg' %} no-repeat center / cover;">
    {% include 'community/top-nav.html' %}

    <div class="hero event-details-hero">

        <div class="container">

            <div class="hero-text">
                <p class="news-category">Your tribe</p>
                <h1 class="hero-title">PEOPLE OF YBF</h1>
            </div>

        </div>

    </div>

</header><!-- /#header -->


<div id="main" class="site-main community">

    <section class="news-page">

        <div class="container container-960">

            <div class="filters-fix">

                <div class="filters-wrapper">

                    <div class="news-filter events-filter ">
                        <span class="filter-label">
                            <ul class="list-unstyled">
                                <li><a id="search" href="javascript:void(0)">Search</a></li>
                                {% for tag in tag_list %}
                                    {% if  tag != "" %}
                                        <li class="user-tags"><a href="javascript:void(0)"
                                               onclick="clickTag('{{ tag }}');" style="text-transform: capitalize;">{{ tag }}</a></li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                            </span>
                        <a href="javascript:void(0)" class="all-events pull-right" onclick="clickAllArticles();">All
                            Users...</a>
                    </div>

                    <div id="search-form" class="events-filter" style="display: none; padding-top: 0;">

                        <div class="container col-sm-12" style="padding-left: 7%">
                            <div class="row">
                                <div class="controls">
                                    <input id="searchBar" class="form-control" type="text" placeholder="keyword..."
                                           onkeyup="realFilter(event)"
                                           style="width: 100%;"/>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <div class="loader" style="display: block; margin-top: 10%"></div>
            <div id="user_list" class="news-page-list" style="display: none;">

                {% include 'community/people_list_content.html' %}

            </div><!-- /.news-list -->

            <nav aria-label="Events list navigation" style="display: block;">
                <ul class="pagination">
                    <li class="text-pagination">
                        <a href="javascript:previous_week();" aria-label="Previous">
                            <span aria-hidden="true">&larr; Prev Page</span>
                        </a>
                    </li>
                    <li class="text-pagination">
                        <a href="javascript:next_week();" aria-label="Next">
                            <span aria-hidden="true">Next Page &rarr;</span>
                        </a>
                    </li>
                </ul>

            </nav>

        </div><!-- /.container -->

    </section><!-- /.news-page -->

</div><!-- /#main -->


<footer id="colophon" class="site-footer pages-footer">

    <div class="container container-960">

        <div class="row">

            <div class="footer-col">
                <a href="#" class="site-logo" rel="home"><img src="{% static 'news/img/logo.png' %}" alt=""></a>
            </div><!-- /.footer-col -->

            <div class="footer-col">
                <h4>News</h4>
                <ul>
                    <li><a href="#">Current</a></li>
                    <li><a href="#">Archive</a></li>
                    <li><a href="#">Submit a story</a></li>
                </ul>
            </div><!-- /.footer-col -->

            <div class="footer-col">
                <h4>Events</h4>
                <ul>
                    <li><a href="#">Browse</a></li>
                    <li><a href="#">Attending</a></li>
                    <li><a href="#">Manage</a></li>
                </ul>
            </div><!-- /.footer-col -->

            <div class="footer-col">
                <h4>Startups</h4>
                <ul>
                    <li><a href="#">Browse</a></li>
                    <li><a href="#">Manage</a></li>
                </ul>
            </div><!-- /.footer-col -->

            <div class="footer-col">
                <h4>Companies</h4>
                <ul>
                    <li><a href="#">Browse</a></li>
                    <li><a href="#">Manage</a></li>
                </ul>
            </div><!-- /.footer-col -->

            <div class="footer-col">
                <h4>Jobs</h4>
                <ul>
                    <li><a href="#">Browse</a></li>
                    <li><a href="#">Manage</a></li>
                </ul>
            </div><!-- /.footer-col -->

            <div class="footer-col">
                <h4>Officespace</h4>
                <ul>
                    <li><a href="/officespace">Browse</a></li>
                </ul>
            </div><!-- /.footer-col -->

            <div class="footer-col">
                <h4>Profile</h4>
                <ul>
                    <li><a href="#">Your Activity</a></li>
                    <li><a href="#">Edit Profile</a></li>
                </ul>
            </div><!-- /.footer-col -->

            <div class="footer-col">
                <h4>Company</h4>
                <ul>
                    <li><a href="#">Support</a></li>
                    <li><a href="#">About YBF</a></li>
                    <li><a href="#">Terms of service</a></li>
                    <li><a href="#">Legal</a></li>
                </ul>
            </div><!-- /.footer-col -->

            <div class="footer-col pull-right text-right">
                <ul>
                    <li><a href="#">Twitter</a></li>
                    <li><a href="#">Instagram</a></li>
                    <li><a href="#">Facebook</a></li>
                    <li><a href="#">LinkedIn</a></li>
                </ul>
            </div><!-- /.footer-col -->

        </div>

    </div><!-- /.container -->

</footer><!-- /#footer -->

{% endblock %}
{% block customscript %}

    <script>
        var pg_num;
        var totalPage;
        var method;
        var value;
        $(function () {
            loading();
            check_loading();
        });

        $(document).ready(function () {
            pg_num = 1;
            totalPage = "{{ total_page }}";
            // visible or invisible search box.
            $('#search').click(function () {
                console.log('search');

                if ($("#search-form").is(':visible')) {
                    $("#search-form").fadeOut();
                } else {
                    $("#search-form").fadeIn();
                }
            });

            $(document.body).click(function (e) {
                //Hide the search bar if visible
                if (e.target.id !== "searchBar" && e.target.id !== "search" && e.target.id !== "contentCheck" && e.target.id !== "categoryCheck") {
                    document.getElementById("searchBar").value = "";
                    $("#search-form").hide();
                }
            });
            ;

        });

        function check_loading() {
            var everythingLoaded = setInterval(function () {
                if (document.readyState === 'complete') {
                    clearInterval(everythingLoaded);
                    loaded(); // this is the function that gets called when everything is loaded
                }
            }, 10);

        }

        function loaded() {
            console.log('loaded');
            $('.loader').hide();
            $("#user_list").show();

        }

        function loading() {
            $('.loader').show();
            $("#user_list").hide();
        }

        function update_item() {
            loading();
            if (method === 'category') {
                console.log(value);
                $('#user_list').html('').load(
                    "{% url 'category' %}?category=" + value + "&&pg_num=" + pg_num, function (response, status, xhr) {
                        if (status === "success") {
                            loaded();
                        }
                    }
                );
            }
            else if (method === 'search') {
                $('#user_list').html('').load(
                    "{% url 'searchUsers' %}?keyword=" + value + "&&pg_num=" + pg_num, function (response, status, xhr) {
                        if (status === "success") {
                            loaded();
                        }
                    }
                );
            }
            else {
                $('#user_list').html('').load(
                    "{% url 'updateUsers' %}?pg_num=" + pg_num, function (response, status, xhr) {
                        if (status === "success") {
                            loaded();
                        }
                    }
                );
            }
        }

        function clickTag(category) {
            method = "category";
            value = category.replace(" ", "-");
            pg_num = 1;
            update_item(value);

        }

        function realFilter(e) {
            if (e.keyCode === 13) {
                console.log('enter');
                searchInput = document.getElementById("searchBar");
                value = searchInput.value.replace(" ", "-");
                method = 'search';
                pg_num = 1;
                update_item(value);
            }
        }

        function previous_week() {
            console.log(pg_num);
            if (pg_num < 0) {
                console.log('no page');
            }
            else {
                pg_num--;
                update_item();
            }
        }

        function next_week() {
            console.log(pg_num);
            pg_num++;
            update_item();

        }

        function clickAllArticles() {
            method = "index";
            pg_num = 1;
            update_item();

        }
    </script>

{% endblock %}
